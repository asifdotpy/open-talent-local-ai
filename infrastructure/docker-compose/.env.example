# TalentAI Platform - Environment Configuration Template
# Copy this file to .env and update with your settings

#=============================================================================
# GENERAL SETTINGS
#=============================================================================
COMPOSE_PROJECT_NAME=talentai
ENVIRONMENT=development  # development, production

#=============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
#=============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=talentai
POSTGRES_USER=talentai
POSTGRES_PASSWORD=  # Set a secure password here (required)
POSTGRES_MAX_CONNECTIONS=100

# Database URLs for services
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

#=============================================================================
# REDIS CONFIGURATION (Message Broker & Cache)
#=============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=  # Set a secure password here (required for production)
REDIS_DB=0
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

#=============================================================================
# MINIO CONFIGURATION (Object Storage - S3 Compatible)
#=============================================================================
MINIO_ENDPOINT=minio:9000
MINIO_ENDPOINT_EXTERNAL=localhost:9000  # For external access
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=  # Set a secure password here (required)
MINIO_BUCKET=talent-ai-videos
MINIO_ACCESS_KEY=${MINIO_ROOT_USER}
MINIO_SECRET_KEY=${MINIO_ROOT_PASSWORD}
MINIO_USE_SSL=false  # Set to true for production with SSL

# Storage paths (local filesystem fallback)
VIDEO_STORAGE_PATH=/var/lib/talent-ai-videos
AVATAR_CACHE_PATH=/var/cache/talent-ai-avatars

#=============================================================================
# OLLAMA CONFIGURATION (Local LLM for Conversation Service)
#=============================================================================
OLLAMA_HOST=ollama
OLLAMA_PORT=11434
OLLAMA_URL=http://${OLLAMA_HOST}:${OLLAMA_PORT}
OLLAMA_MODEL=llama3.1:8b  # Default model
OLLAMA_CONTEXT_SIZE=8192
OLLAMA_TEMPERATURE=0.7
OLLAMA_MAX_TOKENS=2048

# Alternative models to download:
# llama3.1:70b (larger, more accurate, requires 64GB+ RAM)
# llama3.1:8b-instruct-q4_0 (quantized, smaller)
# mistral:7b (alternative)

#=============================================================================
# AVATAR SERVICE CONFIGURATION (Port 8001)
#=============================================================================
AVATAR_SERVICE_PORT=8001
AVATAR_RENDERING_MODE=hybrid  # hybrid, prerender, client, realtime
AVATAR_CACHE_HIT_TARGET=80    # Target 80% cache hit rate
AVATAR_FALLBACK_STRATEGY=silent  # silent, placeholder, queue

# Pre-render settings
PRERENDER_ENABLED=true
PRERENDER_WORKERS=4
PRERENDER_TIMEOUT=300  # seconds
PRERENDER_MAX_RETRIES=3

# WebGL settings
WEBGL_RENDERER=cpu  # cpu, gpu (requires NVIDIA GPU)
MESA_GL_VERSION_OVERRIDE=4.5
LIBGL_ALWAYS_SOFTWARE=1  # Force software rendering

# Avatar assets
AVATAR_MODELS_PATH=/app/models
AVATAR_ANIMATIONS_PATH=/app/animations
DEFAULT_AVATAR=professional-female

#=============================================================================
# VOICE SERVICE CONFIGURATION (Port 8002)
#=============================================================================
VOICE_SERVICE_PORT=8002
VOICE_ENGINE=piper  # piper, edge-tts, openai

# Piper TTS (local, high-quality)
PIPER_MODELS_PATH=/app/piper-models
PIPER_VOICE=en_US-amy-medium
PIPER_SAMPLE_RATE=22050

# Edge TTS (Microsoft, requires internet)
EDGE_TTS_VOICE=en-US-AriaNeural
EDGE_TTS_RATE=+0%
EDGE_TTS_PITCH=+0Hz

# OpenAI TTS (paid, requires API key)
OPENAI_API_KEY=  # Leave empty if not using OpenAI
OPENAI_TTS_MODEL=tts-1  # tts-1, tts-1-hd
OPENAI_TTS_VOICE=alloy  # alloy, echo, fable, onyx, nova, shimmer

# Speech-to-Text
STT_ENGINE=whisper  # whisper, deepgram, google
WHISPER_MODEL=base  # tiny, base, small, medium, large
WHISPER_DEVICE=cpu  # cpu, cuda (requires NVIDIA GPU)

#=============================================================================
# CONVERSATION SERVICE CONFIGURATION (Port 8003)
#=============================================================================
CONVERSATION_SERVICE_PORT=8003
CONVERSATION_STYLE=professional  # professional, casual, technical
MAX_CONVERSATION_HISTORY=10
CONVERSATION_TIMEOUT=300  # seconds

#=============================================================================
# INTERVIEW SERVICE CONFIGURATION (Port 8004)
#=============================================================================
INTERVIEW_SERVICE_PORT=8004
INTERVIEW_DURATION_MAX=3600  # 1 hour max
INTERVIEW_QUESTIONS_MAX=20
INTERVIEW_AUTO_SAVE_INTERVAL=60  # Save every 60 seconds

# Assessment scoring
ASSESSMENT_MIN_SCORE=0
ASSESSMENT_MAX_SCORE=100
ASSESSMENT_PASS_THRESHOLD=70

#=============================================================================
# SCOUT SERVICE CONFIGURATION (Port 8005)
#=============================================================================
SCOUT_SERVICE_PORT=8005
SCOUT_MAX_RESULTS=50
SCOUT_TIMEOUT=30  # seconds

# External API keys (optional - for sourcing features)
GITHUB_API_TOKEN=  # For GitHub talent search
LINKEDIN_API_KEY=  # For LinkedIn search (requires premium)
STACKOVERFLOW_API_KEY=  # For StackOverflow search

#=============================================================================
# AI AUDITING SERVICE CONFIGURATION (Port 8006)
#=============================================================================
AI_AUDITING_SERVICE_PORT=8006
AUDIT_LOG_RETENTION_DAYS=365  # Keep audit logs for 1 year
AUDIT_COMPLIANCE_LEVEL=standard  # standard, strict, enterprise

#=============================================================================
# ANALYTICS SERVICE CONFIGURATION (Port 8007)
#=============================================================================
ANALYTICS_SERVICE_PORT=8007
ANALYTICS_RETENTION_DAYS=90  # Keep analytics data for 90 days
ANALYTICS_EXPORT_FORMAT=json  # json, csv, xlsx

#=============================================================================
# EXPLAINABILITY SERVICE CONFIGURATION (Port 8008)
#=============================================================================
EXPLAINABILITY_SERVICE_PORT=8008
BIAS_DETECTION_ENABLED=true
BIAS_THRESHOLD=0.7  # 0.0-1.0, higher = stricter
EXPLAINABILITY_DETAIL_LEVEL=detailed  # basic, detailed, comprehensive

#=============================================================================
# PROJECT SERVICE CONFIGURATION (Port 8009)
#=============================================================================
PROJECT_SERVICE_PORT=8009
PROJECT_MAX_MEMBERS=100
PROJECT_AUTO_ARCHIVE_DAYS=365  # Archive inactive projects after 1 year

#=============================================================================
# CANDIDATE SERVICE CONFIGURATION (Port 8010)
#=============================================================================
CANDIDATE_SERVICE_PORT=8010
CANDIDATE_PROFILE_MAX_SIZE=10MB
CANDIDATE_RESUME_ALLOWED_FORMATS=pdf,docx,txt
CANDIDATE_DATA_RETENTION_DAYS=730  # 2 years

#=============================================================================
# NOTIFICATION SERVICE CONFIGURATION (Port 8011)
#=============================================================================
NOTIFICATION_SERVICE_PORT=8011

# Email configuration
SMTP_HOST=  # e.g., smtp.gmail.com
SMTP_PORT=587
SMTP_USER=  # Your email address
SMTP_PASSWORD=  # Your email password or app password
SMTP_FROM_EMAIL=noreply@talentai-platform.com
SMTP_FROM_NAME=TalentAI Platform

# Notification settings
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_BATCH_SIZE=50
NOTIFICATION_RATE_LIMIT=100  # emails per hour

#=============================================================================
# SECURITY SERVICE CONFIGURATION (Port 8012)
#=============================================================================
SECURITY_SERVICE_PORT=8012
SECURITY_PASSWORD_MIN_LENGTH=8
SECURITY_PASSWORD_REQUIRE_UPPERCASE=true
SECURITY_PASSWORD_REQUIRE_NUMBERS=true
SECURITY_PASSWORD_REQUIRE_SPECIAL=true
SECURITY_SESSION_TIMEOUT=3600  # 1 hour
SECURITY_MAX_LOGIN_ATTEMPTS=5
SECURITY_LOCKOUT_DURATION=900  # 15 minutes

#=============================================================================
# USER SERVICE CONFIGURATION (Port 8013)
#=============================================================================
USER_SERVICE_PORT=8013
USER_EMAIL_VERIFICATION_REQUIRED=true
USER_PROFILE_PHOTO_MAX_SIZE=5MB
USER_DEFAULT_ROLE=candidate  # candidate, recruiter, interviewer, admin

#=============================================================================
# GENKIT SERVICE CONFIGURATION (Port 3400)
#=============================================================================
GENKIT_SERVICE_PORT=3400
GOOGLE_GENAI_API_KEY=  # Required for Genkit AI flows
GENKIT_LOG_LEVEL=info

#=============================================================================
# AI ORCHESTRA SIMULATION (Port 3001)
#=============================================================================
AI_ORCHESTRA_PORT=3001
AI_ORCHESTRA_RENDERER=webgl  # webgl, headless
AI_ORCHESTRA_CACHE_ENABLED=true

#=============================================================================
# CELERY CONFIGURATION (Background Task Queue)
#=============================================================================
CELERY_BROKER_URL=${REDIS_URL}
CELERY_RESULT_BACKEND=${REDIS_URL}
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=600  # 10 minutes max per task
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000

# Celery workers
CELERY_RENDER_WORKERS=4  # Avatar pre-render workers
CELERY_GENERAL_WORKERS=2  # General background tasks

#=============================================================================
# FRONTEND CONFIGURATION
#=============================================================================
FRONTEND_PORT=3000
VITE_API_BASE_URL=http://localhost:8080  # API gateway/Nginx
VITE_WS_URL=ws://localhost:8080/ws  # WebSocket for real-time updates

#=============================================================================
# NGINX CONFIGURATION (Reverse Proxy)
#=============================================================================
NGINX_PORT=8080
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_KEEPALIVE_TIMEOUT=65
NGINX_CLIENT_MAX_BODY_SIZE=100M  # Max upload size

# SSL/TLS (for production)
SSL_ENABLED=false
SSL_CERTIFICATE_PATH=/etc/nginx/ssl/cert.pem
SSL_CERTIFICATE_KEY_PATH=/etc/nginx/ssl/key.pem

#=============================================================================
# LOGGING CONFIGURATION
#=============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json, text
LOG_OUTPUT=stdout  # stdout, file, both

# Log files (if LOG_OUTPUT=file or both)
LOG_DIR=/var/log/talentai
AVATAR_SERVICE_LOG=${LOG_DIR}/avatar-service.log
VOICE_SERVICE_LOG=${LOG_DIR}/voice-service.log
CONVERSATION_SERVICE_LOG=${LOG_DIR}/conversation-service.log
INTERVIEW_SERVICE_LOG=${LOG_DIR}/interview-service.log
SCOUT_SERVICE_LOG=${LOG_DIR}/scout-service.log
ANALYTICS_SERVICE_LOG=${LOG_DIR}/analytics-service.log

#=============================================================================
# SECURITY CONFIGURATION
#=============================================================================
# JWT Authentication
JWT_SECRET_KEY=  # Set a secure 32+ character secret key here (required)
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS settings
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_ALLOWED_HEADERS=*

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10

#=============================================================================
# DESKTOP APP SPECIFIC SETTINGS
#=============================================================================
DESKTOP_MODE=false  # Set to true when running in desktop app
AUTO_START_SERVICES=false
SHOW_SYSTEM_TRAY=false
ENABLE_AUTO_UPDATES=false
UPDATE_CHECK_INTERVAL=86400  # Check for updates daily

#=============================================================================
# MONITORING & HEALTH CHECKS
#=============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30  # seconds
HEALTH_CHECK_TIMEOUT=10  # seconds
HEALTH_CHECK_RETRIES=3

# Prometheus metrics (optional)
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Grafana (optional)
GRAFANA_ENABLED=false
GRAFANA_PORT=3001
GRAFANA_ADMIN_PASSWORD=  # Set a secure password here if using Grafana

#=============================================================================
# BACKUP CONFIGURATION
#=============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_DIRECTORY=/var/backups/talentai
BACKUP_COMPRESSION=gzip  # gzip, bzip2, xz, none

#=============================================================================
# DEVELOPMENT SETTINGS (override in .env.development)
#=============================================================================
DEBUG=false
HOT_RELOAD=false
MOCK_EXTERNAL_APIS=false
SKIP_AUTH=false  # Only for local development!

#=============================================================================
# RESOURCE LIMITS (Docker)
#=============================================================================
# PostgreSQL
POSTGRES_MEMORY_LIMIT=2g
POSTGRES_CPU_LIMIT=2.0

# Redis
REDIS_MEMORY_LIMIT=512m
REDIS_CPU_LIMIT=0.5

# MinIO
MINIO_MEMORY_LIMIT=1g
MINIO_CPU_LIMIT=1.0

# Ollama (requires more resources for LLM)
OLLAMA_MEMORY_LIMIT=8g  # 16g for llama3.1:70b
OLLAMA_CPU_LIMIT=4.0

# Microservices
SERVICE_MEMORY_LIMIT=1g
SERVICE_CPU_LIMIT=1.0

# Celery workers
CELERY_WORKER_MEMORY_LIMIT=2g
CELERY_WORKER_CPU_LIMIT=2.0

#=============================================================================
# NOTES
#=============================================================================
# 1. Copy this file to .env before starting services
# 2. Set secure passwords for all empty password fields above
# 3. For production: Enable SSL, set ENVIRONMENT=production
# 4. Minimal setup works with default values (except passwords)
# 5. GPU rendering requires NVIDIA GPU + nvidia-docker runtime
